# User Story 1 手動測試清單

**測試目標**: HuskyLens 積木定義驗證  
**測試日期**: _待填寫_  
**測試人員**: _待填寫_  
**環境要求**: VS Code + Singular Blockly Extension Development Host

---

## 測試前準備

### 環境設定

-   [ ] 已安裝 VS Code
-   [ ] 已安裝 Node.js 和 npm
-   [ ] 已執行 `npm install` 安裝所有依賴
-   [ ] 已執行 `npm run compile` 編譯專案
-   [ ] 已建立測試工作區資料夾 (例如: `test-workspace`)

### 啟動測試環境

1. 在 VS Code 中開啟 Singular Blockly 專案
2. 按 F5 啟動 Extension Development Host
3. 在 Extension Development Host 中開啟測試工作區資料夾
4. 建立新的 `.blockly` 檔案 (例如: `huskylens_test.blockly`)
5. 驗證 Blockly 編輯器正常載入

---

## 驗收場景測試

### 場景 1: 工具箱中顯示所有 11 個 HuskyLens 積木

**Given**: 開啟 Blockly 編輯器  
**When**: 查看工具箱中的「視覺感測器」分類  
**Then**: 應看到所有 11 個 HuskyLens 積木並正確分組

#### 測試步驟

1. [ ] 在 Blockly 編輯器中點擊工具箱的「視覺感測器」分類
2. [ ] 向下滾動到 HuskyLens 區域 (在 HUSKYLENS 標籤下方)

#### 驗證清單

**初始化積木** (3 個):

-   [ ] 「初始化 HUSKYLENS (I2C)」積木存在
-   [ ] 「初始化 HUSKYLENS (UART)」積木存在,包含 RX 和 TX 腳位選單
-   [ ] 「設定 HUSKYLENS 演算法為」積木存在,包含 7 個演算法選項

**資料查詢積木** (6 個):

-   [ ] 「請求 HUSKYLENS 辨識結果」積木存在
-   [ ] 「HUSKYLENS 已學習物體」積木存在 (布林輸出)
-   [ ] 「HUSKYLENS 偵測到的方塊數量」積木存在 (數值輸出)
-   [ ] 「取得方塊 [數字] 的 [選項]」積木存在,包含 5 個資訊類型選項
-   [ ] 「HUSKYLENS 偵測到的箭頭數量」積木存在 (數值輸出)
-   [ ] 「取得箭頭 [數字] 的 [選項]」積木存在,包含 5 個資訊類型選項

**學習功能積木** (2 個):

-   [ ] 「讓 HUSKYLENS 學習 ID [數字]」積木存在,包含數字輸入 (預設值 1)
-   [ ] 「讓 HUSKYLENS 忘記所有學習」積木存在

#### 預期結果

-   [ ] 所有 11 個積木都能在工具箱中看到
-   [ ] 積木按功能分組且有適當的分隔線
-   [ ] 無 JavaScript 錯誤出現在 DevTools Console

---

### 場景 2: 從工具箱拖曳每個 HuskyLens 積木到工作區且無錯誤

**Given**: 工具箱中有所有 11 個 HuskyLens 積木  
**When**: 逐一拖曳每個積木到工作區  
**Then**: 所有積木都能正常放置且顯示正確

#### 測試步驟

1. [ ] 拖曳「初始化 HUSKYLENS (I2C)」積木到工作區
2. [ ] 拖曳「初始化 HUSKYLENS (UART)」積木到工作區
3. [ ] 拖曳「設定 HUSKYLENS 演算法為」積木到工作區
4. [ ] 拖曳「請求 HUSKYLENS 辨識結果」積木到工作區
5. [ ] 拖曳「HUSKYLENS 已學習物體」積木到工作區
6. [ ] 拖曳「HUSKYLENS 偵測到的方塊數量」積木到工作區
7. [ ] 拖曳「取得方塊 [數字] 的 [選項]」積木到工作區
8. [ ] 拖曳「HUSKYLENS 偵測到的箭頭數量」積木到工作區
9. [ ] 拖曳「取得箭頭 [數字] 的 [選項]」積木到工作區
10. [ ] 拖曳「讓 HUSKYLENS 學習 ID [數字]」積木到工作區
11. [ ] 拖曳「讓 HUSKYLENS 忘記所有學習」積木到工作區

#### 驗證清單

**每個積木都應該**:

-   [ ] 能從工具箱拖曳到工作區
-   [ ] 在工作區中正確顯示
-   [ ] 顯示正確的顏色 (感測器藍綠色)
-   [ ] 顯示正確的文字標籤 (繁體中文)
-   [ ] 無 JavaScript 錯誤

#### 預期結果

-   [ ] 所有 11 個積木成功放置在工作區
-   [ ] 無任何錯誤訊息或警告
-   [ ] 積木視覺外觀正常 (無異常顏色、形狀錯誤)

---

### 場景 3: 下拉選單顯示正確選項並可選擇

**Given**: 所有 HuskyLens 積木已放置在工作區  
**When**: 點擊每個下拉選單  
**Then**: 顯示正確的選項清單且可正常選擇

#### 測試步驟

##### 3.1 測試「初始化 HUSKYLENS (UART)」RX/TX 腳位選單

1. [ ] 點擊 RX 腳位下拉選單
2. [ ] 驗證選項包含當前板型的所有可用數位腳位
3. [ ] 選擇一個腳位 (例如: 10)
4. [ ] 驗證選擇成功反映在積木上
5. [ ] 點擊 TX 腳位下拉選單
6. [ ] 驗證選項包含當前板型的所有可用數位腳位
7. [ ] 選擇一個腳位 (例如: 11)
8. [ ] 驗證選擇成功反映在積木上

**預期腳位選項** (Arduino Uno/Nano):

-   [ ] 包含 D0-D13 (或板型特定的數位腳位)
-   [ ] 選項格式正確 (例如: "D10", "10" 等,取決於實作)

##### 3.2 測試「設定 HUSKYLENS 演算法為」下拉選單

1. [ ] 點擊演算法下拉選單
2. [ ] 驗證包含以下 7 個選項:
    - [ ] 人臉辨識
    - [ ] 物體追蹤
    - [ ] 物體辨識
    - [ ] 線路追蹤
    - [ ] 顏色辨識
    - [ ] 標籤辨識
    - [ ] 物體分類
3. [ ] 選擇「人臉辨識」
4. [ ] 驗證選擇成功反映在積木上
5. [ ] 再次點擊下拉選單
6. [ ] 選擇「物體追蹤」
7. [ ] 驗證選擇成功反映在積木上

##### 3.3 測試「取得方塊」資訊類型下拉選單

1. [ ] 點擊資訊類型下拉選單
2. [ ] 驗證包含以下 5 個選項:
    - [ ] X 中心
    - [ ] Y 中心
    - [ ] 寬度
    - [ ] 高度
    - [ ] **ID** (驗證使用大寫)
3. [ ] 選擇「X 中心」
4. [ ] 驗證選擇成功反映在積木上
5. [ ] 再次點擊下拉選單
6. [ ] 選擇「ID」
7. [ ] 驗證選擇成功反映在積木上

**🔴 關鍵驗證**: 確認 dropdown 顯示的是 "ID" 而非 "id"

##### 3.4 測試「取得箭頭」資訊類型下拉選單

1. [ ] 點擊資訊類型下拉選單
2. [ ] 驗證包含以下 5 個選項:
    - [ ] X 起點
    - [ ] Y 起點
    - [ ] X 終點
    - [ ] Y 終點
    - [ ] **ID** (驗證使用大寫)
3. [ ] 選擇「X 起點」
4. [ ] 驗證選擇成功反映在積木上
5. [ ] 再次點擊下拉選單
6. [ ] 選擇「ID」
7. [ ] 驗證選擇成功反映在積木上

**🔴 關鍵驗證**: 確認 dropdown 顯示的是 "ID" 而非 "id"

#### 預期結果

-   [ ] 所有下拉選單都能正常開啟
-   [ ] 所有選項都正確顯示
-   [ ] 選項可以正常選擇且反映在積木上
-   [ ] RX/TX 腳位選單根據板型動態顯示正確腳位
-   [ ] 資訊類型選單中的「ID」為大寫 ✅

---

### 場景 4: 數字輸入欄位正確顯示預設值且可編輯

**Given**: HuskyLens 積木已放置在工作區  
**When**: 檢查數字輸入欄位  
**Then**: 顯示正確的預設值且可以編輯

#### 測試步驟

##### 4.1 測試「取得方塊」索引欄位

1. [ ] 檢查「取得方塊」積木的索引欄位
2. [ ] 驗證預設值為 0
3. [ ] 點擊索引欄位
4. [ ] 輸入新的數字 (例如: 2)
5. [ ] 驗證數字成功更新

**預期行為**:

-   [ ] 預設值: 0
-   [ ] 可編輯
-   [ ] 最小值限制: 0 (不允許負數)

##### 4.2 測試「取得箭頭」索引欄位

1. [ ] 檢查「取得箭頭」積木的索引欄位
2. [ ] 驗證預設值為 0
3. [ ] 點擊索引欄位
4. [ ] 輸入新的數字 (例如: 1)
5. [ ] 驗證數字成功更新

**預期行為**:

-   [ ] 預設值: 0
-   [ ] 可編輯
-   [ ] 最小值限制: 0 (不允許負數)

##### 4.3 測試「讓 HUSKYLENS 學習 ID」數字積木

1. [ ] 檢查「讓 HUSKYLENS 學習 ID」積木的輸入埠
2. [ ] 驗證包含一個數字 shadow block
3. [ ] 驗證 shadow block 預設值為 1
4. [ ] 點擊數字 shadow block
5. [ ] 輸入新的數字 (例如: 5)
6. [ ] 驗證數字成功更新

**預期行為**:

-   [ ] 輸入埠包含 shadow block
-   [ ] Shadow block 類型為 math_number
-   [ ] 預設值: 1
-   [ ] 可以替換為其他數字積木或變數

#### 預期結果

-   [ ] 所有數字欄位顯示正確的預設值
-   [ ] 數字欄位可以正常編輯
-   [ ] 最小值限制正確 (索引不允許負數)
-   [ ] Shadow block 正確設定且可替換

---

### 場景 5: 積木連接規則正確 (statement vs expression)

**Given**: HuskyLens 積木已放置在工作區  
**When**: 嘗試連接積木  
**Then**: 積木按照正確的連接規則連接或拒絕連接

#### 測試步驟

##### 5.1 測試 Statement 積木 (指令積木)

**應該有 previous/next connection 的積木**:

1. [ ] 初始化 HUSKYLENS (I2C)
2. [ ] 初始化 HUSKYLENS (UART)
3. [ ] 設定 HUSKYLENS 演算法為
4. [ ] 請求 HUSKYLENS 辨識結果
5. [ ] 讓 HUSKYLENS 學習 ID
6. [ ] 讓 HUSKYLENS 忘記所有學習

**測試方法**:

1. [ ] 拖曳一個「執行設定」積木到工作區
2. [ ] 嘗試將上述每個積木連接到「執行設定」積木內部
3. [ ] 驗證所有積木都能成功連接

##### 5.2 測試 Expression 積木 (回傳值積木)

**應該有 output connection 的積木**:

1. [ ] HUSKYLENS 已學習物體 (Boolean)
2. [ ] HUSKYLENS 偵測到的方塊數量 (Number)
3. [ ] 取得方塊 [數字] 的 [選項] (Number)
4. [ ] HUSKYLENS 偵測到的箭頭數量 (Number)
5. [ ] 取得箭頭 [數字] 的 [選項] (Number)

**測試方法**:

1. [ ] 拖曳「如果」邏輯積木到工作區
2. [ ] 嘗試將「HUSKYLENS 已學習物體」積木連接到「如果」條件埠
3. [ ] 驗證連接成功 (Boolean 類型匹配)
4. [ ] 拖曳「印出」積木到工作區
5. [ ] 嘗試將「HUSKYLENS 偵測到的方塊數量」積木連接到「印出」輸入埠
6. [ ] 驗證連接成功 (Number 類型可轉換為 String)
7. [ ] 重複測試其他回傳值積木

##### 5.3 測試類型檢查

1. [ ] 拖曳「邏輯值 真」積木
2. [ ] 嘗試將「HUSKYLENS 偵測到的方塊數量」積木 (Number) 連接到「如果」條件埠 (期望 Boolean)
3. [ ] 驗證 Blockly 是否允許或拒絕此連接

**預期行為**:

-   [ ] Blockly 可能允許 (會自動類型轉換)
-   [ ] 或 Blockly 拒絕 (嚴格類型檢查)
-   [ ] 無論如何,行為應一致且符合專案設定

#### 預期結果

-   [ ] Statement 積木有 previous/next connection
-   [ ] Expression 積木有 output connection
-   [ ] Boolean 積木可連接到邏輯條件埠
-   [ ] Number 積木可連接到數值輸入埠
-   [ ] 積木連接行為符合 Blockly 類型系統

---

### 場景 6: 工具提示 (Tooltip) 正確顯示

**Given**: HuskyLens 積木已放置在工作區  
**When**: 滑鼠懸停在每個積木上  
**Then**: 顯示有意義的工具提示說明

#### 測試步驟

1. [ ] 滑鼠懸停在「初始化 HUSKYLENS (I2C)」積木上
2. [ ] 驗證顯示: "使用 I2C 初始化 HUSKYLENS 智慧鏡頭"
3. [ ] 滑鼠懸停在「初始化 HUSKYLENS (UART)」積木上
4. [ ] 驗證顯示: "使用 UART 初始化 HUSKYLENS 智慧鏡頭,設定 RX/TX 腳位"
5. [ ] 滑鼠懸停在「設定 HUSKYLENS 演算法為」積木上
6. [ ] 驗證顯示: "設定 HUSKYLENS 使用的辨識演算法"
7. [ ] 滑鼠懸停在「請求 HUSKYLENS 辨識結果」積木上
8. [ ] 驗證顯示: "從 HUSKYLENS 請求最新的辨識結果"
9. [ ] 滑鼠懸停在「HUSKYLENS 已學習物體」積木上
10. [ ] 驗證顯示: "檢測 HUSKYLENS 是否已學習任何物體"
11. [ ] 滑鼠懸停在其他積木並驗證工具提示

#### 預期結果

-   [ ] 所有積木都有工具提示
-   [ ] 工具提示文字清晰易懂
-   [ ] 工具提示使用正確的語言 (繁體中文)
-   [ ] 工具提示準確描述積木功能

---

## 多語言測試 (選做)

### 測試切換到英文

1. [ ] 在 VS Code 設定中切換語言為 English
2. [ ] 重新啟動 Extension Development Host
3. [ ] 開啟 Blockly 編輯器
4. [ ] 驗證所有 HuskyLens 積木標籤變為英文
5. [ ] 驗證工具提示也變為英文

**預期行為**:

-   [ ] 積木標籤使用英文
-   [ ] 下拉選單選項使用英文
-   [ ] 工具提示使用英文
-   [ ] 無 i18n 錯誤或缺失的翻譯

---

## 整合測試

### 建立完整的 HuskyLens 測試程式

#### 測試場景: 人臉辨識範例

1. [ ] 建立新的 Blockly 工作區
2. [ ] 拖曳以下積木並連接:

    ```
    執行設定
    ├─ 初始化 HUSKYLENS (I2C)
    ├─ 設定 HUSKYLENS 演算法為 [人臉辨識]
    └─ 延遲 1000 毫秒

    重複執行
    ├─ 請求 HUSKYLENS 辨識結果
    ├─ 如果 [HUSKYLENS 已學習物體]
    │  └─ 印出 [取得方塊 0 的 ID]
    └─ 延遲 100 毫秒
    ```

3. [ ] 驗證所有積木正確連接
4. [ ] 儲存工作區
5. [ ] 生成 Arduino 程式碼 (透過預覽功能)
6. [ ] 驗證程式碼無語法錯誤

#### 測試場景: 物體追蹤與座標顯示

1. [ ] 建立新的 Blockly 工作區
2. [ ] 拖曳以下積木並連接:

    ```
    執行設定
    ├─ 初始化 HUSKYLENS (UART) [RX=10, TX=11]
    ├─ 設定 HUSKYLENS 演算法為 [物體追蹤]
    └─ 延遲 1000 毫秒

    重複執行
    ├─ 請求 HUSKYLENS 辨識結果
    ├─ 如果 [HUSKYLENS 偵測到的方塊數量] > 0
    │  ├─ 印出 "X: " + [取得方塊 0 的 X 中心]
    │  └─ 印出 "Y: " + [取得方塊 0 的 Y 中心]
    └─ 延遲 100 毫秒
    ```

3. [ ] 驗證所有積木正確連接
4. [ ] 驗證數學運算積木可與 HuskyLens 積木組合
5. [ ] 儲存工作區
6. [ ] 生成 Arduino 程式碼

**預期結果**:

-   [ ] 積木組合邏輯正確
-   [ ] 無連接錯誤或類型不匹配警告
-   [ ] 工作區可正常儲存和載入
-   [ ] 生成的程式碼結構合理

---

## 錯誤處理測試

### 測試 1: 拖曳大量積木

1. [ ] 拖曳 50+ 個 HuskyLens 積木到工作區
2. [ ] 驗證編輯器性能正常
3. [ ] 驗證無 JavaScript 錯誤
4. [ ] 驗證可以正常縮放和平移工作區

### 測試 2: 刪除和復原

1. [ ] 放置多個 HuskyLens 積木
2. [ ] 選擇並刪除幾個積木
3. [ ] 使用 Ctrl+Z 復原刪除
4. [ ] 驗證積木正確恢復
5. [ ] 使用 Ctrl+Y 重做刪除
6. [ ] 驗證積木再次被刪除

### 測試 3: 複製和貼上

1. [ ] 選擇一組連接的 HuskyLens 積木
2. [ ] 使用 Ctrl+C 複製
3. [ ] 使用 Ctrl+V 貼上
4. [ ] 驗證積木正確複製且保持連接
5. [ ] 驗證欄位值也被正確複製

---

## 測試結果總結

### 通過/失敗統計

-   **場景 1**: [ ] 通過 / [ ] 失敗
-   **場景 2**: [ ] 通過 / [ ] 失敗
-   **場景 3**: [ ] 通過 / [ ] 失敗
-   **場景 4**: [ ] 通過 / [ ] 失敗
-   **場景 5**: [ ] 通過 / [ ] 失敗
-   **場景 6**: [ ] 通過 / [ ] 失敗
-   **整合測試**: [ ] 通過 / [ ] 失敗
-   **錯誤處理**: [ ] 通過 / [ ] 失敗

### 發現的問題

| 編號 | 問題描述 | 嚴重程度 | 重現步驟 | 預期行為 | 實際行為 |
| ---- | -------- | -------- | -------- | -------- | -------- |
| 1    |          |          |          |          |          |
| 2    |          |          |          |          |          |
| 3    |          |          |          |          |          |

### 測試結論

-   [ ] 所有驗收場景通過 ✅
-   [ ] 部分場景失敗,需要修正 ❌
-   [ ] 需要進一步測試 ⏳

### 簽核

**測試人員**: ********\_********  
**測試日期**: ********\_********  
**審核人員**: ********\_********  
**審核日期**: ********\_********

---

**注意事項**:

1. 本測試清單應在實際 Blockly 編輯器環境中執行
2. 發現任何問題應立即記錄到「發現的問題」表格
3. 截圖或錄影可以幫助理解和重現問題
4. 測試完成後請更新 tasks.md 中的 T028 狀態
